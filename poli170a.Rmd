---
title: "poli170a"
author: "Kelly Gong"
date: "2024-05-31"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
# merged_df <- read_csv("/Users/kellygong/Downloads/merged_df.csv")
merged_df <- read_csv("merged_df.csv")

```
```{r}
library(stats)
# Fit the linear model with log-transformed variables
full_model <- lm(crime_density ~ alcohol_density + density, data=merged_df)

# Print the summary of the model
summary(full_model)
```
```{r}
library(ggplot2)
p <- ggplot(merged_df, aes(x = alcohol_density, y = crime_density, color = density)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE, color = "red") + 
  labs(
    x = 'Alcohol License per capita',
    y = 'Crime Incidents per capita',
    title = 'Relationship Between Alcohol Licenses and Crime Rates per Capita',
    color = 'Population Density'
  ) +
  scale_color_gradient(low = "lightblue", high = "darkblue") +
  theme_minimal() +
  theme(
    legend.position = "right",
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 8),
    legend.key.size = unit(1.5, "lines")
  )

print(p)
ggsave("scatterplot_license_vs_crime_density.png", plot = p, dpi = 300)
```
